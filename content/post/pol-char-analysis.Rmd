---
title: "Political Characteristics Analysis"
author: ""
date: "2020-06-23"
output:
  blogdown::html_page:
    toc: true
editor_options: 
  chunk_output_type: inline
---
```{r set up, warning=FALSE, include=FALSE, message= FALSE}
# Do not edit this code block/chunk
knitr::opts_chunk$set(cache = FALSE,echo = FALSE, message=FALSE, warning = FALSE)

##fig.width = 16/2, fig.height = 9/2

library(tidyverse)
library(data.table)
library(knitr)
library(kableExtra)
library(scales)
library(gridExtra)
library(stargazer)
`%!in%` = Negate(`%in%`)
```



```{r file config}


dyn<- read.csv("D:/cpr/up-dynasties/dyn_other_data/dyn_ae_ge.csv")

dyn$n_sc_minster <- NULL
dyn$n_sc_minister <- NULL
dyn$minister_dur <- NULL




dyn <- dyn %>%  filter(year %!in% c(1974))

#summary(nrega)

dyn$dyn_cum_text <- ifelse(dyn$dyn_cum ==0, "Non-family","Family")

dyn$fam_rel_id_uniq <-  paste(dyn$family_id, dyn$rel_id_uniq,sep = "")


dyn$fam_exp_cum_cat <- factor(dyn$fam_exp_cum_cat, levels=c("[0,1)","[1,6)","[6,11)","[11,21)","[21,Inf]"))

###four way elections


dyn_test <- dyn %>% mutate(contest_type_1 =case_when(position ==1 &dyn_cum ==0 ~1,
                                                                                                                        position ==2 &dyn_cum ==0 ~2,
                                                                                                                        position ==1 &dyn_cum ==1 ~3,
                                                                                                                        position ==2 &dyn_cum ==1 ~5)) %>% group_by( election_type,year,constituency_no) %>% mutate(sum_cont_type = sum(contest_type_1)) %>% mutate(contest_type =ifelse(sum_cont_type ==3, "non-fam v/s non-fam",ifelse(sum_cont_type ==5, "fam v/s non-fam", ifelse(sum_cont_type ==6, "non-fam v/s fam", ifelse(sum_cont_type ==8, "fam v/s fam", "NA")))))


# dyn_test %>% group_by( year,constituency_no) %>% summarise(sum = sum(contest_type)) %>%group_by(sum) %>%  summarise(n())

#table(dyn_test$contest_type)

dyn$contest_type <- dyn_test$contest_type



dyn_ae <- dyn %>% filter(election_type =="AE")


dyn_ge <- dyn %>% filter(election_type =="GE")


```



## Summary


```{r}

dyn %>% filter(position==1)%>% group_by(election_type,dyn_cum_text)  %>% summarise(count = n()) %>% group_by(election_type) %>% mutate(sum = sum(count), prop = (count/sum)) %>% select(election_type,dyn_cum_text, prop) %>% kable(caption = "Summary of the data", col.names = c("Election Type", "Politician's Identity", "Proportion"), digit = 2) %>% kable_styling(bootstrap_options = "striped")

```


## Margin of Victory


```{r}

dyn %>% filter(position==1)%>% group_by(election_type,dyn_cum_text) %>% summarise(mean(margin_percentage))  %>% kable(caption = "Margin of victory wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Average MOV percentage"), digit = 1) %>% kable_styling(bootstrap_options = "striped")


```




```{r 4 way table config}



dyn_test <- dyn %>% mutate(contest_type_1 =case_when(position ==1 &dyn_cum ==0 ~1,
                                                                                                                        position ==2 &dyn_cum ==0 ~2,
                                                                                                                        position ==1 &dyn_cum ==1 ~3,
                                                                                                                        position ==2 &dyn_cum ==1 ~5)) %>% group_by( election_type,year,constituency_no) %>% mutate(sum_cont_type = sum(contest_type_1)) %>% mutate(contest_type =ifelse(sum_cont_type ==3, "non-fam v/s non-fam",ifelse(sum_cont_type ==5, "fam v/s non-fam", ifelse(sum_cont_type ==6, "non-fam v/s fam", ifelse(sum_cont_type ==8, "fam v/s fam", "NA")))))



# dyn_test %>% group_by( year,constituency_no) %>% summarise(sum = sum(contest_type)) %>%group_by(sum) %>%  summarise(n())

#table(dyn_test$contest_type)

dyn$contest_type <- dyn_test$contest_type


```

```{r}

# dyn %>% filter(position==1)%>% group_by(election_type,contest_type) %>% summarise(mean(margin_percentage))  %>% 
```


## Turnout

```{r}

dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(turnout_percentage))%>% kable(caption = "Turnout percentage wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Average turnout percentage"), digit = 1) %>% kable_styling(bootstrap_options = "striped")


```

```{r}
dyn %>% filter(position==1)%>% group_by(election_type,contest_type) %>% summarise(mean(turnout_percentage))  %>% kable(caption = "Turnout percentage wrt contest type", col.names = c("Election Type", "contest type", "Average turnout percentage"), digit = 1) %>% kable_styling(bootstrap_options = "striped")

```


## Effective number of parties


```{r}
dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(enop)) %>% 
  kable(caption = "Effective  number of parties wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Average enop"), digit = 1) %>% kable_styling(bootstrap_options = "striped")

```



## Number of candidates


```{r}
dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(n_cand)) %>% 
  kable(caption = "Number of candidates wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Average n_candidates"), digit = 1) %>% kable_styling(bootstrap_options = "striped")

```

## Turncoat

```{r}

dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(turncoat)) %>% 
  kable(caption = "Turncoats proportion wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Turncoat proportion"), digit = 2) %>% kable_styling(bootstrap_options = "striped")


```


## Same party

```{r}

dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(same_party, na.rm = TRUE)) %>% kable(caption = "Party retention wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Retention proportion"), digit = 2) %>% kable_styling(bootstrap_options = "striped")


```


<!-- ##  Party -->

<!-- ```{r} -->
<!-- dyn %>% filter(position==1) %>% group_by(election_type,dyn_cum_text, party) %>% summarise(count = n()) %>% filter(count >10) -->
<!-- ``` -->


## Incumbent

```{r}

dyn%>% filter(position==1) %>% group_by(election_type,dyn_cum_text) %>% summarise(mean(incumbent, na.rm = TRUE)) %>% kable(caption = "Proportion of incumbents wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Proportion of incumbents"), digit = 2) %>% kable_styling(bootstrap_options = "striped")


```


## Recontest


```{r}

dyn %>% filter(position==1)%>% group_by(election_type,dyn_cum_text) %>% summarise(mean(recontest)) %>% 
  kable(caption = "Proportion of recontestants wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Proportion of recontestants"), digit = 2) %>% kable_styling(bootstrap_options = "striped")


```

## Number of terms


```{r}

dyn %>% filter(position==1)%>% group_by(election_type,dyn_cum_text) %>% summarise(mean(no_terms)) %>% 
  kable(caption = "Number of terms wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Average numer of terms"), digit = 1) %>% kable_styling(bootstrap_options = "striped")


```


## Constituency type


```{r}

dyn %>% filter(position==1)%>% group_by(election_type,dyn_cum_text,constituency_type) %>% filter(constituency_type != "ST") %>% summarise(count = n()) %>% group_by(election_type,dyn_cum_text) %>% mutate(sum = sum(count), prop = count/sum) %>% select(election_type,dyn_cum_text,constituency_type, prop) %>% kable(caption = "Constituency type wrt Politicians identity", col.names = c("Election Type", "Politician's Identity", "Constituency Type","Proportion"), digit = 2) %>% kable_styling(bootstrap_options = "striped")

```



<!-- ## constituency type -->


<!-- ```{r} -->

<!-- dyn %>% group_by(election_type,dyn_cum_text)  %>% summarise(count = n()) %>% group_by(election_type,dyn_cum_text) %>% mutate(sum = sum(count), prop = count/sum) %>% select(election_type,dyn_cum_text,constituency_type, prop) -->

<!-- ``` -->


<!-- ## sub region -->


<!-- ```{r} -->

<!-- dyn_ge %>% filter(position==1)%>% group_by(election_type,dyn_cum_text, sub_region) %>% summarise(n()) -->

<!-- ``` -->

#Raphael

# Vote dispersion


```{r}
rafael <- fread("D:/cpr/up-dynasties/dyn_other_data/rafael-dataset.csv", stringsAsFactors = FALSE)

# dim(rafael)
# 
# names(rafael)
# 
unique(rafael$year)
# 
# unique(rafael$position)

rafael_up <- rafael %>% select(year, constituency_no, position, totalvotes, partynew, partypercent)

# summary(rafael_up)

dyn_rafael <- merge(dyn_ae, rafael_up, by = c("year", "constituency_no", "position"), allow.cartesian = TRUE)

```



```{r}
dyn_rafael %>% filter(position==1 & partypercent <100&  partypercent >10) %>% group_by(constituency_no) %>% mutate(var = var(partypercent) ) %>% group_by(dyn_cum_text) %>% summarise(var_mean = mean(var)) %>% 
  kable(caption = "Vote dispersion at booth level wrt Politicians identity", col.names = c("Politician's Identity", "Variance"), digit = 0) %>% kable_styling(bootstrap_options = "striped")
```

```{r}
dyn_rafael %>% filter(position==1 & partypercent <100&  partypercent >10) %>% group_by(constituency_no) %>% mutate(sd = sd(partypercent) ) %>% group_by(dyn_cum_text) %>% summarise(sd_mean = mean(sd)) %>% 
  kable(caption = "Vote dispersion at booth level wrt Politicians identity", col.names = c("Politician's Identity", "SD"), digit = 1) %>% kable_styling(bootstrap_options = "striped")
```


<!-- ```{r} -->
<!-- ggplot(dyn_rafael %>% filter(position==1 & partypercent <100) , aes(dyn_cum_text, partypercent))+ -->
<!--   geom_boxplot() -->
<!-- ``` -->

```{r}
ggplot(dyn_rafael %>% filter(position==1  & year == 2017) , aes(partypercent, color =dyn_cum_text))+
  geom_density(size = 1)+
  xlim(10, 90)+
  #facet_grid(~dyn_cum_text )+
  theme_minimal()+
    theme(plot.margin = unit(c(.5,.5,.5,.5), "cm"))+
  labs(title = "Distribution of booth level votes",  x = "Percentage of votes", y = "Density") +
  theme(legend.position = "top",
        plot.background = element_blank(),
        plot.title = element_text(family = "serif",hjust = 0.5, size = 20), 
        plot.subtitle = element_text(hjust = 0.5, size = 15,
                                     margin = margin(t = 0, r = 0, b = 20, l = 0)),
        text = element_text(color = "gray20",family = "serif"),
        axis.text.x = element_text( 
                                   hjust = .5, vjust = 0),
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        axis.text = element_text(face = "italic", size = 10),
        axis.title.x = element_text(vjust = 1, size = 15,
                                  margin = margin(t = 20, r = 0, b = 0, l = 0)),  
        axis.title.y = element_text(vjust = 1, size = 15),
        axis.ticks = element_blank(),
        panel.grid.major = element_line(color = "gray50", size = .5),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank()
  ) 

```

<!-- ## Mobilisation -->


<!-- ```{r} -->


<!-- dyn$mob <- dyn$vote_share_percentage * dyn$turnout_percentage -->

<!-- # mean(dyn_ae_ge$vote_share_percentage) -->
<!-- #  -->
<!-- # hist(mob) -->

<!-- dyn %>% group_by( election_type,dyn_cum_text) %>% summarise(mean(mob)/100) %>%  kable(caption = "Mobilisation wrt Politicians identity", col.names = c("Election Type", "Politician's identity", "Mobilisation score"), digit = 1) %>% kable_styling(bootstrap_options = "striped") -->


<!-- dyn %>% group_by(election_type, contest_type) %>% summarise(mean(mob)/100) %>%  kable(caption = "Mobilisation wrt type of contest", col.names = c("Election Type", "Type of contest", "Mobilisation score"), digit = 1) %>% kable_styling(bootstrap_options = "striped") -->
<!-- ``` -->

# Cabinet ministers




```{r summary}


cabinet <- read.csv("D:/cpr/up-dynasties/dyn_other_data/up_cabinet_01.07.20.csv")

#glimpse(cabinet)

names(cabinet) <- tolower(names(cabinet))

names(cabinet) <- make.unique(names(cabinet))

cabinet <- cabinet %>% rename(year = election_year_1)





cabinet$rel_id_unique <- as.numeric(cabinet$rel_id_unique)

cabinet <- cabinet %>% filter(rel_id_unique >0 )

# cabinet$term_duration <- NA
# 
# cabinet$term_duration[cabinet$year == 1996] <- 6
# 
# cabinet$term_duration[cabinet$year %in% c(1977,1980,2002, 2007, 2012, 2017)]<- 5
# 
# cabinet$term_duration[cabinet$year == 1985]<- 4
# 
# cabinet$term_duration[cabinet$year %in% c(1993,1977, 1974)]<- 3
# 
# cabinet$term_duration[cabinet$year %in% c(1989,1991)]<- 2



## Linkages




# dyn <- read.csv("D:/cpr/up-dynasties/dyn_29.06.20.csv")
# 
# 
# dyn  <- dyn %>% filter(election_type %in% c("AE", "GE"))
#dyn_19 <- dyn %>% filter(year == 2019) 



####

cabinet <- cabinet %>% mutate(pre_90 = case_when(dplyr::between(year, 1977,1990)~ 1,
                             TRUE ~0), post_90 =case_when(dplyr::between(year, 1990,2017)~ 1,
                             TRUE ~0) )


#table(cabinet$post_90)


dyn_cabinet <-  cabinet  %>% filter(year!= "" & family_id >0 & family_id != "UK") %>% group_by(family_id) %>%summarise(n_sc_minster = n(), minister_dur = sum(term_months, na.rm = TRUE), pre_90_n = sum(pre_90), post_90_n = sum(post_90))

dyn_cabinet$min_dur_yr <- round(dyn_cabinet$minister_dur/12,2)





dyn_ae_ge_cabinet <- merge(dyn ,dyn_cabinet, by ="family_id", allow.cartesian = TRUE, all.x =TRUE )



dyn_uniq_last_ind <- dyn_ae_ge_cabinet %>%  group_by(family_id) %>% arrange(-year) %>% distinct(family_id, .keep_all = TRUE) 





```



```{r regression variables, results= "asis"}
N_minister <- dyn_uniq_last_ind$n_sc_minster%>% replace_na(0)

minister_duration <- dyn_uniq_last_ind$min_dur_yr %>% replace_na(0)

dynast <- dyn_uniq_last_ind$dyn_tot

pre_90 <- ifelse(dyn_uniq_last_ind$pre_90_n >0,1,0) %>% replace_na(0)

post_90 <- ifelse(dyn_uniq_last_ind$post_90_n >0,1,0) %>% replace_na(0)



decades <- paste(pre_90, post_90, sep = "")

decades <- case_when(decades == "00"~ "Never",
                     decades %in% c("11","10")~"Pre-90",
                     TRUE ~ "Post-90")

link <- ifelse(dyn_uniq_last_ind$level %in% c("AE","GE"),0,1) %>% replace_na(0)
```





```{r regression, results= "asis"}
fit.1 <- glm(dynast ~ N_minister+decades+link, family =  binomial(link = "probit"))

fit.2 <- glm(dynast ~ decades+link, family =  binomial(link = "probit"))

fit.3 <- glm(dynast ~ minister_duration+decades +link, family =  binomial(link = "probit"))
#summary(fit.2)

#summary(fit.2)
# stargazer(fit, fit_logit, fit_turnout,omit = c("bjp" ), title="Probit regression Results",type = "html",
# align=TRUE, dep.var.labels=c("Vote share percentage","Winner", "Turnout percentage"),
# omit.stat=c("LL","ser","f"), no.space=TRUE)


stargazer(fit.1, fit.2,fit.3,title="Regression Results",type = "html",
align=TRUE,dep.var.labels=c("Dynast - 1/0","Dynast - 1/0","Dynast - 1/0"),
omit.stat=c("LL","ser","f"), no.space=TRUE)

```


<!-- ```{r} -->
<!-- cabinet %>% group_by(year) %>%  summarise(count = n()) %>% kable() -->

<!-- ``` -->


<!-- ```{r} -->

<!-- dyn_uniq_ind_ae <- dyn%>% filter(election_type =="AE" &position ==1 ) %>% group_by(fam_rel_id_uniq) %>% filter( year == max(year)) %>% distinct(family_id, .keep_all = TRUE) -->

<!-- dyn_uniq_ind_ae %>% filter( n_sc_minster >0) %>% group_by(dyn_cum_text) %>% summarise(mean(n_sc_minster)) %>%  -->
<!--   kable(caption = "Cabinet minsters wrt Politicians identity", col.names = c("Politician's Identity", "Average number of cabinet minsters"), digit = 2) %>% kable_styling(bootstrap_options = "striped") -->
<!-- ``` -->



<!-- ## cab reg -->

<!-- ```{r} -->
<!-- dyn_uniq_ind_ae$n_sc_minster_d <- ifelse(dyn_uniq_ind_ae$n_sc_minster>0,1,0) -->

<!-- fit <- lm(data = dyn_uniq_ind_ae , dyn_tot ~  n_sc_minster_d) -->

<!-- summary(fit)  -->
<!-- ``` -->






<!-- ```{r} -->

<!-- dyn_uniq_ind_ae <- dyn%>% filter(election_type =="AE" &position ==1 ) %>% group_by(fam_rel_id_uniq) %>% filter( year == max(year)) %>% distinct(family_id, .keep_all = TRUE) -->

<!-- dyn_uniq_ind_ae %>% filter( n_sc_minster >0) %>% group_by(dyn_cum_text) %>% summarise(mean(n_sc_minster)) %>%  -->
<!--   kable(caption = "Cabinet minsters wrt Politicians identity", col.names = c("Politician's Identity", "Average number of cabinet minsters"), digit = 2) %>% kable_styling(bootstrap_options = "striped") -->
<!-- ``` -->



<!-- ## cab reg -->

<!-- ```{r} -->
<!-- dyn_uniq_ind_ae$n_sc_minster_d <- ifelse(dyn_uniq_ind_ae$n_sc_minster>0,1,0) -->

<!-- fit <- lm(data = dyn_uniq_ind_ae , dyn_tot ~  n_sc_minster_d) -->

<!-- summary(fit)  -->
<!-- ``` -->

<!-- ## regression -->

<!-- ```{r} -->
<!-- #names(dyn_uniq_ind_ae) -->

<!-- #dim(dyn_uniq_ind_ae) -->

<!-- dyn_uniq_ind_ae <- dyn%>% filter(election_type =="AE" & position==1 ) %>% group_by(fam_rel_id_uniq) %>% filter( year == max(year)) %>% distinct(family_id, .keep_all = TRUE) -->

<!-- dyn_uniq_ind_ae$n_sc_minster_d <- ifelse(dyn_uniq_ind_ae$n_sc_minster>0,1,0)  -->


<!-- dyn_uniq_ind_ae$minister <- ifelse(dyn_uniq_ind_ae$n_sc_minster>0,1,0) %>% replace_na(0) -->

<!-- minister_duration <- ifelse(dyn_uniq_ind_ae$minister_dur>0,dyn_uniq_ind_ae$minister_dur,0) %>% replace_na(0) -->

<!-- dyn_uniq_ind_ae$association <- ifelse(dyn_uniq_ind_ae$association_inv >0,1,0) %>% replace_na(0) -->

<!-- dyn_uniq_ind_ae$organisation <- ifelse(dyn_uniq_ind_ae$org_inv > 0,1,0) %>% replace_na(0) -->

<!-- dyn_uniq_ind_ae$politics <- ifelse(dyn_uniq_ind_ae$pol_inv >0,1,0) %>% replace_na(0) -->



<!-- dynast <- dyn_uniq_ind_ae$dyn_tot -->

<!-- position <- dyn_uniq_ind_ae$position -->

<!-- family_size <- dyn_uniq_ind_ae$fam_size_tot -->

<!-- family_experience <-  dyn_uniq_ind_ae$fam_exp_tot -->





<!-- tab <- cbind(data.frame(table(association)),data.frame(table(organisation)),data.frame(table(politics)))  -->
<!-- #tab %>%  make.unique(names(tab))%>% select(1:2, 3:3, 5:5) -->

<!-- names(tab) <- make.unique(names(tab)) -->

<!-- tab %>% select(association,Freq, Freq.1, Freq.2) %>% kable(col.names = c("involvement","Association", "Organisation", "Politics" )) -->

<!-- data.frame(table(organisation)) -->

<!-- data.frame(table(politics)) -->

<!-- fit <- lm(dynast ~  minister +minister_duration + association + organisation + politics+ minister *minister_duration) -->


<!-- summary(fit) -->


<!-- involve -->


<!-- ``` -->

<!-- ## Mobility -->

<!-- ```{r } -->

<!-- dyn <- dyn %>% group_by(family_id) %>% mutate(el_n_uniq = n_distinct(election_type)) -->

<!-- dyn$first_el <- NA -->

<!-- first_election <- dyn %>% group_by(family_id) %>% filter(year == min(year)) %>% select(election_type) %>% rename(first_election = election_type) -->

<!-- # dyn$first_election <- NULL -->
<!-- #  -->
<!-- # first_elction <- dyn %>% group_by(family_id) %>% mutate(first_election = election_type[ first_year== year]) %>% select(election_type) -->

<!-- dyn <- merge(dyn,first_election, by = "family_id", all.x = TRUE, allow.cartesian = TRUE) -->

<!-- dyn_uniq_ind <- dyn %>% group_by(fam_rel_id_uniq) %>% filter( year == max(year)) %>% distinct(family_id, .keep_all = TRUE) -->

<!--   dyn_uniq_ind %>% filter(el_n_uniq>1 &dyn_tot ==1) %>% group_by(first_election) %>% summarise(n= n(), prop = n/284)                                           -->

<!-- first_el = if_else(election_type == "GE"[year==min(year)], "GE", "AE"))  -->






<!-- dyn_uniq_ind_ae %>% group_by(dyn_tot) %>% count(association) %>% group_by(dyn_tot) %>% mutate(sum = sum(n), prop = n/sum) %>% select( prop) %>% rename(association= prop) , -->

<!-- dyn_uniq_ind_ae %>% group_by(dyn_tot) %>% count(organisation) %>% group_by(dyn_tot) %>% mutate(sum = sum(n), prop = n/sum) %>% select( prop) %>% rename(organisation= prop)) %>% select(-dyn_tot, -dyn_tot1, -dyn_tot2) -->


<!-- ``` -->




<!-- ```{r} -->
<!-- dyn %>%  distinct(family_id, .keep_all = TRUE) %>% filter(dyn_tot == 1 & el_n_uniq >1) %>% group_by (first_el) %>% summarise(count = n()) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- mobilty, talk to jatin - within ge/ae - what makes -  -->
<!-- ``` -->



<!-- ```{r} -->
<!-- mob_tab <-  dyn %>% group_by(family_id)  %>% distinct(family_id, .keep_all = TRUE) %>% group_by(dyn_tot,el_n_uniq) %>% summarise(count = n()) %>% group_by(dyn_tot) %>% mutate(sum = sum(count), prop = count/sum) %>% filter(dyn_tot == 1) %>% select(dyn_tot, prop) -->

<!-- mob_text <- data.frame(c("No", "Yes")) -->

<!-- cbind(mob_text, mob_tab) %>% select(1:1, 3:3) %>% kable(caption = "Mobility among families", col.names = c("Mobility", "Proportion")) -->

<!-- inv_tab <- cbind(dyn_uniq_ind_ae %>% group_by(dyn_tot) %>% count(politics) %>% group_by(dyn_tot) %>% mutate(sum = sum(n), prop = n/sum) %>% select( prop) %>% rename(politics= prop) -->

<!-- inv_tab_text <- data.frame(c("Non-family_No", "Non-family_Yes", "Family_No", "Family_Yes")) -->


<!-- cbind(inv_tab_text,inv_tab ) %>% select(-dyn_tot) %>% kable(col.names = c("Involvement", "Politics", "Association", "Organisation"), digits = 2) -->


<!-- ``` -->














